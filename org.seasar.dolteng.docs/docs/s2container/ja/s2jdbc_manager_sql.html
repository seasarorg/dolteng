<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">










<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
<meta http-equiv="Content-Language" content="ja" /> 
<meta http-equiv="Content-Style-Type" content="text/css" /> 
<title>Seasar2 - S2JDBC - JdbcManager - SQLによる操作</title>
<link rel="stylesheet" type="text/css" href="http://www.seasar.org/theme/main.css" media="screen,projection" />
<link rel="stylesheet" type="text/css" href="http://www.seasar.org/theme/print.css" media="print" />
<link href="./css/maven-base.css" type="text/css" rel="stylesheet" media="screen" />
<link href="./css/maven-theme.css" type="text/css" rel="stylesheet" media="screen" />
</head>

<body>

<div id="wrapper">

<div id="header">

<div class="line"><span class="hide">spacer</span></div>

<div id="logo"><h1 id="h01" class="hide">The Seasar Foundation Project Site</h1><img src="http://www.seasar.org/images/seasar_logo_blue.gif" alt="The Seasar Foundation" width="390" height="180" /></div>

<div id="tool">

<h2><a href="http://search.seasar.org/">Site Search</a></h2>

<form id="search" action="http://search.seasar.org/">
<div>
	<input id="search_phrase" type="text" name="phrase" size="20" />
	<input type="hidden" name="perpage" value="30" />
	<input type="hidden" name="enc" value="UTF-8" />
	<input id="search_go" type="submit" value="Search" />
</div>
</form>

<h2>Seasar Banner</h2>

<p><a href="http://www.seasar.org/images/seasar_banner.gif"><img src="http://www.seasar.org/images/seasar_banner.gif" alt="Seasar Banner" title="Seasar Banner" width="146" height="33" /></a></p>

</div>

<div id="navi">
<p><a href="../en/">English</a> | <a href="../ja/">Japanese</a></p>
</div>

</div><!-- header -->

<div id="contents_left">
           
  

  
    
  
  
                   <h2>About</h2>
        <ul>
              
    <li class="none">
              <a href="index.html">ホーム</a>
        </li>
              
    <li class="none">
              <a href="license.html">ライセンス</a>
        </li>
              
    <li class="none">
              <a href="downloads.html">ダウンロード</a>
        </li>
              
    <li class="none">
              <a href="http://www.seasar.org/wiki/index.php?ChangeLog%2FSeasar">ChangeLog</a>
        </li>
              
    <li class="none">
              <a href="http://www.seasar.org/wiki/index.php?SeasarUpdateOperationLog">移行ガイド</a>
        </li>
          </ul>
          <h2>ドキュメント</h2>
        <ul>
              
    <li class="none">
              <a href="documents.html">一覧</a>
        </li>
              
    <li class="none">
              <a href="setup.html">セットアップ</a>
        </li>
              
    <li class="none">
              <a href="DIContainer.html">DIContainer</a>
        </li>
              
    <li class="none">
              <a href="aop.html">AOP</a>
        </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
            
            
      
                  
      
              
            <li class="expanded">
              <a href="s2jdbc.html">S2JDBC</a>
                <ul>
                  
    <li class="none">
              <a href="s2jdbc_abstract.html">S2JDBCとは</a>
        </li>
                  
    <li class="none">
              <a href="s2jdbc_tutorial.html">チュートリアル</a>
        </li>
                  
    <li class="none">
              <a href="s2jdbc_setup.html">セットアップ</a>
        </li>
                  
    <li class="none">
              <a href="s2jdbc_entity.html">エンティティ</a>
        </li>
                  
                
              
      
            
            
            
      
              
            <li class="expanded">
              <a href="s2jdbc_manager.html">JdbcManager</a>
                <ul>
                  
    <li class="none">
              <a href="s2jdbc_manager_auto.html">SQL自動生成による操作</a>
        </li>
                  
    <li class="none">
              <strong>SQLによる操作</strong>
        </li>
                  
    <li class="none">
              <a href="s2jdbc_manager_sqlfile.html">SQLファイルによる操作</a>
        </li>
              </ul>
        </li>
                  
    <li class="none">
              <a href="s2jdbc_other.html">その他の機能</a>
        </li>
              </ul>
        </li>
              
    <li class="none">
              <a href="http://www.seasar.org/wiki/index.php?FAQ%2FS2Container">FAQ (全般)</a>
        </li>
              
    <li class="none">
              <a href="http://www.seasar.org/wiki/index.php?FAQ%2FS2AOP">FAQ (AOP)</a>
        </li>
          </ul>
          <h2>Javadoc</h2>
        <ul>
              
    <li class="none">
              <a href="../s2-framework/ja/apidocs/index.html">S2-Framework</a>
        </li>
              
    <li class="none">
              <a href="../s2-extension/ja/apidocs/index.html">S2-Extension</a>
        </li>
              
    <li class="none">
              <a href="../s2-tiger/ja/apidocs/index.html">S2-Tiger</a>
        </li>
          </ul>
          <h2>モジュール</h2>
        <ul>
              
    <li class="none">
              <a href="index.html">Seasar2</a>
        </li>
              
    <li class="none">
              <a href="../s2-framework/ja/index.html">S2-Framework</a>
        </li>
              
    <li class="none">
              <a href="../s2-extension/ja/index.html">S2-Extension</a>
        </li>
              
    <li class="none">
              <a href="../s2-tiger/ja/index.html">S2-Tiger</a>
        </li>
          </ul>
          <h2>プロジェクト文書</h2>
        <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
              <a href="project-info.html">プロジェクト情報</a>
              </li>
          </ul>
                                       <a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy" name="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png" />
          </a>
                       
  

  
    
  
  
  </div><!-- contents_left -->

<div id="contents_center">

<div id="article">
<div class="section"><h2><a name="SQLによる操作"></a>
SQLによる操作</h2>
<ul><li><a href="#検索">検索</a>
<ul><li><a href="#複数件検索">複数件検索</a>
</li>
<li><a href="#1件検索">1件検索</a>
</li>
<li><a href="#イテレーションによる検索">イテレーションによる検索</a>
</li>
<li><a href="#検索結果の行数取得">検索結果の行数取得</a>
</li>
<li><a href="#ページング">ページング</a>
</li>
</ul>
</li>
<li><a href="#挿入・更新・削除">挿入・更新・削除</a>
<ul><li><a href="#1件挿入・更新・削除">1件挿入・更新・削除</a>
</li>
<li><a href="#バッチ挿入・更新・削除">バッチ挿入・更新・削除</a>
</li>
<li><a href="#バッチ更新のサイズを指定する">
									バッチ更新のサイズを指定する
								</a>
</li>
</ul>
</li>
<li><a href="#ストアドの呼び出し">ストアドの呼び出し</a>
<ul><li><a href="#ストアドプロシージャの呼び出し">
									ストアドプロシージャの呼び出し
								</a>
</li>
<li><a href="#ストアドファンクションの呼び出し">
									ストアドファンクションの呼び出し
								</a>
</li>
</ul>
</li>
</ul>
</div>
<div class="section"><h2><a name="検索"></a>
検索</h2>
<div class="section"><h3><a name="複数件検索"></a>
複数件検索</h3>
<p>
					SQLを使って複数件検索をする場合は、
					<code>selectBySql()</code>
					と
					<code>getResultList()</code>
					を組み合わせます。
				</p>
<div class="source"><pre>
List&lt;EmployeeDto&gt; results = jdbcManager
    .selectBySql(EmployeeDto.class, &quot;select ... where department_id = ?&quot;, 10)
    .getResultList();
</pre>
</div>
<p>
					結果を
					<code>Map</code>
					で受け取ることもできます。
				</p>
<div class="source"><pre>
List&lt;BeanMap&gt; results = jdbcManager
    .selectBySql(BeanMap.class, &quot;select ...&quot;)
    .getResultList();
</pre>
</div>
<p>
					BeanMapはMap&lt;String, Object&gt;なクラスで、
					存在しないキーにアクセスすると 例外が発生します。
					キーの値は、AAA_BBBのような'_'記法の値ををaaaBbbのようなキャメル記法に
					変換したものです。
				</p>
<p>
					このルールは、convention.diconで指定されている
					<code>
						org.seasar.framework.convention.impl.PersistenceNamingConventionImpl
					</code>
					のfromColumnNameToPropertyName()の実装を変えることで、カスタマイズすることができます。
				</p>
<p>
					デフォルトでは、結果がなかった場合は、 空の
					<code>List</code>
					が返されます。
					<code>disallowNoResult()</code>
					を呼び出すと、 結果がなかった場合は
					<code>javax.persistence.NoResultException</code>
					が発生します。
				</p>
<div class="source"><pre>
List&lt;BeanMap&gt; results = jdbcManager
    .selectBySql(BeanMap.class, &quot;select ...&quot;)
    .disallowNoResult()
    .getResultList();
</pre>
</div>
</div>
<div class="section"><h3><a name="a1件検索"></a>
1件検索</h3>
<p>
					SQLを使って1件検索をする場合は、
					<code>selectBySql()</code>
					と
					<code>getSingleResult()</code>
					を組み合わせます。
				</p>
<div class="source"><pre>
Integer count = jdbcManager
    .selectBySql(Integer.class, &quot;select count(*) from emp&quot;)
    .getSingleResult();
</pre>
</div>
<p>
					結果を
					<code>Map</code>
					で受け取ることもできます。
				</p>
<div class="source"><pre>
BeanMap result = jdbcManager
    .selectBySql(BeanMap.class, &quot;select ...&quot;)
    .getSingleResult();
</pre>
</div>
<p>
					BeanMapはMap&lt;String, Object&gt;なクラスで、
					存在しないキーにアクセスすると 例外が発生します。
					キーの値は、AAA_BBBのような'_'記法の値ををaaaBbbのようなキャメル記法に
					変換したものです。
				</p>
<p>
					このルールは、convention.diconで指定されている
					<code>
						org.seasar.framework.convention.impl.PersistenceNamingConventionImpl
					</code>
					のfromColumnNameToPropertyName()の実装を変えることで、カスタマイズすることができます。
				</p>
<p>
					デフォルトでは、結果がなかった場合は、
					<code>null</code>
					が返されます。
					<code>disallowNoResult()</code>
					を呼び出すと、 結果がなかった場合は
					<code>javax.persistence.NoResultException</code>
					が発生します。
				</p>
<div class="source"><pre>
BeanMap result = jdbcManager
    .selectBySql(BeanMap.class, &quot;select ...&quot;)
    .disallowNoResult()
    .getSingleResult();
</pre>
</div>
</div>
<div class="section"><h3><a name="イテレーションによる検索"></a>
イテレーションによる検索</h3>
<p>
					検索結果が多くの行を返すため、
					<code>List</code>
					でまとめて受け取ることが困難な場合は
					<code>iterate(IterationCallback)</code>
					を使います。
				</p>
<div class="source"><pre>
int count = results = jdbcManager
    .selectBySql(BeanMap.class, &quot;select ...&quot;)
    .iterate(new IterationCallback&lt;BeanMap, Integer&gt;() {
        int count;
        public Integer iterate(BeanMap map, IterationContext context) {
            if (...) {
                ++count;
            }
            return count;
        }
    });
</pre>
</div>
<p><code>iterate(IterationCallback)</code>
					の引数には、 次のインターフェースを実装したクラスのインスタンスを渡します。
				</p>
<ul><li><code>
								org.seasar.extension.jdbc.IterationCallback&lt;ENTITY,
								RESULT&gt;
							</code></li>
</ul>
<p><code>ENTITY</code>
					は
					<code>selectBySql()</code>
					で指定したクラス、
					<code>RESULT</code>
					は
					<code>iterate(IterationCallback)</code>
					が返す結果の型を指定します。
				</p>
<p>問い合わせ結果の1行ごとに次のメソッドがコールバックされます。</p>
<ul><li><code>
								RESULT iterate(ENTITY entity,
								IterationContext context)
							</code></li>
</ul>
<p>
					コールバックメソッドが最後に返した値が
					<code>iterate(IterationCallback)</code>
					の戻り値となります。
				</p>
<p>
					コールバックメソッドの第2引数で渡される
					<code>
						org.seasar.extension.jdbc.IterationContext
					</code>
					の
					<code>exit</code>
					プロパティを
					<code>true</code>
					にすると、 問い合わせ結果のイテレーションは終了となり、 検索結果の残りは無視されます。
					その時の戻り値が
					<code>iterate(IterationCallback)</code>
					の戻り値となります。
				</p>
</div>
<div class="section"><h3><a name="検索結果の行数取得"></a>
検索結果の行数取得</h3>
<p>
					SELECT COUNT(*)
					～による検索結果の行数を取得する場合は、getCountBySql()を使います。
				</p>
<div class="source"><pre>
long count = jdbcManager.getCountBySql(&quot;select ...&quot;);
</pre>
</div>
<p>
					このメソッドは通常、
					<code>
						select count(*) from (
						<var>SQL</var>
						)
					</code>
					を 実行した結果を返します。
				</p>
</div>
<div class="section"><h3><a name="ページング"></a>
ページング</h3>
<p>
					ページングを指定する場合は、
					<code>limit(), offset()</code>
					を使います。
					<code>limit()</code>
					には、取得する行数を指定します。
					<code>offset()</code>
					には、最初に取得する行の位置を指定します。 最初の行の位置は0になります。
					ページングを指定するには、必ず
					<code>ordey by</code>
					句が必要です。 order by句で指定するカラムは、selectリストにも含めるようにしてください。
				</p>
<div class="source"><pre>
jdbcManager.selectBySql(EmployeeDto.class,
    &quot;select id, name from employee order by name&quot;)
    .limit(100)
    .offset(10)
    .getResultList();
</pre>
</div>
</div>
</div>
<div class="section"><h2><a name="挿入更新削除"></a>
挿入・更新・削除</h2>
<div class="section"><h3><a name="a1件挿入更新削除"></a>
1件挿入・更新・削除</h3>
<p>
					SQLを使ってエンティティを更新する場合は、
					<code>updateBySql()</code>
					、
					<code>params()</code>
					、
					<code>execute()</code>
					を組み合わせます。
					<code>updateBySql()</code>
					の2番目以降の引数はパラメータのクラスの可変長引数です。 挿入、削除も
					<code>updateBySql()</code>
					を使います。
				</p>
<div class="source"><pre>
int count = jdbcManager.updateBySql(
    &quot;update employee set salary = ? where id = ?&quot;, BigDecimal.class, Integer.class)
    .params(null, 1)
    .execute();
</pre>
</div>
<p>
					一意制約違反によりエンティティを挿入ができなかった場合は、
					<code>javax.persistence.EntityExistsException</code>
					が発生します。
				</p>
</div>
<div class="section"><h3><a name="バッチ挿入更新削除"></a>
バッチ挿入・更新・削除</h3>
<p>
					SQLを使って複数エンティティをバッチ更新する場合は、
					<code>updateBatchBySql()</code>
					、
					<code>params()</code>
					、
					<code>execute()</code>
					を組み合わせます。
					<code>updateBatchBySql()</code>
					の2番目以降の引数はパラメータのクラスの可変長引数です。 挿入、削除も
					<code>updateBatchBySql()</code>
					を使います。
				</p>
<div class="source"><pre>
List&lt;EmployeeDto&gt; dtoList = ...;
...
SqlBatchUpdate batchUpdate = jdbcManager.updateBatchBySql(
    &quot;update employee set salary = ? where id = ?&quot;, BigDecimal.class, Integer.class);
for (EmployeeDto dto : dtoList) {
    batchUpdate.params(dto.salary, dto.id);
}
int[] countArray = batchUpdate.execute();
</pre>
</div>
<p>
					一意制約違反によりエンティティを挿入ができなかった場合は、
					<code>javax.persistence.EntityExistsException</code>
					が発生します。
				</p>
</div>
<div class="section"><h3><a name="バッチ更新のサイズを指定する"></a>
バッチ更新のサイズを指定する</h3>
<p>
					バッチ更新のサイズを設定するには
					<code>batchSize()</code>
					を使います。
				</p>
<div class="source"><pre>
List&lt;EmployeeDto&gt; dtoList = ...;
...
SqlBatchUpdate batchUpdate = jdbcManager.updateBatchBySql(
    &quot;update employee set salary = ? where id = ?&quot;, BigDecimal.class, Integer.class);
for (EmployeeDto dto : dtoList) {
    batchUpdate.params(dto.salary, dto.id);
}
int[] countArray = batchUpdate.batchSize(50).execute();
</pre>
</div>
</div>
</div>
<div class="section"><h2><a name="ストアドの呼び出し"></a>
ストアドの呼び出し</h2>
<div class="section"><h3><a name="ストアドプロシージャの呼び出し"></a>
ストアドプロシージャの呼び出し</h3>
<p>
					SQLを使ってストアドプロシージャを呼び出す場合は、
					<code>callBySql()</code>
					と
					<code>execute()</code>
					を組み合わせます。
					<code>callBySql()</code>
					の最初の引数は、 ストアドプロシージャを呼び出すSQLです。
				</p>
<p>最初の例は、パラメータのない場合です。</p>
<div class="source"><pre>
jdbcManager.callBySql(&quot;{call myproc}&quot;).execute();
</pre>
</div>
<p>
					INのパラメータが1つだけで、そのパラメータが
					<code>null</code>
					にならない場合は、
					<code>callBySql()</code>
					の2番目の引数で値を直接指定します。
				</p>
<div class="source"><pre>
jdbcManager.callBySql(&quot;{call myproc(?)}&quot;, &quot;hoge&quot;).execute();
</pre>
</div>
<p>
					上記以外の場合は、
					<code>callBySql()</code>
					の2番目の引数にJavaBeansを指定します。
					プロシージャを呼び出すパラメータの順番にJavaBeansのフィールドを定義します。
				</p>
<ul><li>
							フィールドにアノテーションが付けられていない場合、
							<code>IN</code>
							パラメータになります。
						</li>
<li>
							フィールドに
							<code>@Out</code>
							アノテーションが付けられている場合、
							<code>OUT</code>
							パラメータになります。
						</li>
<li>
							フィールドに
							<code>@InOut</code>
							アノテーションが付けられている場合、
							<code>INOUT</code>
							パラメータになります。
						</li>
<li>
							フィールドに
							<code>@ResultSet</code>
							アノテーションが付けられている場合、 パラメータ以外で戻される結果セットになります。
							ただし、 OracleやPostgreSQLのように、
							パラメータ以外で結果セットを返すことが出来ないRDBMSの場合は、
							<code>OUT</code>
							パラメータとして扱われます。
						</li>
<li>
							フィールドに
							<code>@Lob</code>
							が付けられている場合、 そのパラメータはLOBとして扱われます。
							<code>@Lob</code>
							アノテーションは他のアノテーションと組み合わせて使用することが出来ます。
						</li>
</ul>
<div class="source"><pre>
public class MyDto {
    public String arg1; // 第1引数 (IN)

    @Out
    public String arg2; // 第2引数 (OUT)

    @InOut
    public int arg3;    // 第3引数 (INOUT)

    @ResultSet
    public List&lt;String&gt; result; // 結果セット
}
</pre>
</div>
<div class="source"><pre>
MyDto dto = new MyDto();
dto.arg1 = &quot;hoge&quot;;
dto.arg3 = 2;
jdbcManager.callBySql(&quot;{call myproc(?, ?, ?)}&quot;, dto).execute();
System.out.println(dto.arg2);
System.out.println(dto.arg3);
System.out.println(dto.result);
</pre>
</div>
<p>
					ストアドプロシージャが複数のカラムを持つ結果セットを返す場合は、
					対応するフィールドの型をList&lt;結果セットの行に対応するJavaBeansの型&gt;にします。
				</p>
<div class="source"><pre>
public class MyDto {
    public int arg1; // 第1引数 (IN)

    @ResultSet
    public List&lt;EmployeeDto&gt; result; // 結果セット
}
</pre>
</div>
<div class="source"><pre>
MyDto dto = new MyDto();
dto.arg1 = 1;
jdbcManager.callBySql(&quot;{call myproc(?)}&quot;, dto).execute();
System.out.println(dto.result);
</pre>
</div>
<p>
					オラクルとPostgreSQLの場合は、結果セットをパラメータで受け取る必要があります。
					これらのRDBMSでは、
					<code>@ResultSet</code>
					アノテーションが付けられたパラメータは
					<code>OUT</code>
					パラメータとして扱われるので、
					ストアドプロシージャ呼び出しのSQLの中に対応するバインド変数を付け加えます。
				</p>
<div class="source"><pre>
public class MyDto {
    public int arg1; // 第1引数 (IN)

    @ResultSet
    public List&lt;EmployeeDto&gt; result; // 第2引数 (OUT)
}
</pre>
</div>
<div class="source"><pre>
MyDto dto = new MyDto();
dto.arg1 = 1;
jdbcManager.callBySql(&quot;{call myproc(?, ?)}&quot;, dto).execute();
System.out.println(dto.result);
</pre>
</div>
</div>
<div class="section"><h3><a name="ストアドファンクションの呼び出し"></a>
ストアドファンクションの呼び出し</h3>
<p>
					SQLを使ってストアドファンクションを呼び出す場合は、
					<code>callBySql()</code>
					と、
					<code>getSingleResult()</code>
					または
					<code>getResultList()</code>
					を組み合わせます。
					<code>callBySql()</code>
					の1番目の引数でストアドファンクションの戻り値の型を指定します。
					2番目の引数でストアドファンクションを呼び出すSQLを指定します。
				</p>
<p>最初の例はパラメータがなく、 戻り値が結果セットでない場合です。</p>
<div class="source"><pre>
String result = jdbcManager.callBySql(String.class, &quot;{? = call myfunc}&quot;)
                           .getSingleResult();
</pre>
</div>
<p>
					OracleやPostgreSQLのように、
					ストアドファンクションの戻り値で結果セットを返すことが出来る場合は
					<code>getResultList()</code>
					で結果の
					<code>List</code>
					を受け取ります。
					<code>callBySql()</code>
					の1番目の引数で
					<code>List</code>
					の要素の型を指定します。
				</p>
<div class="source"><pre>
List&lt;String&gt; result = jdbcManager.callBySql(String.class, &quot;{? = call myfunc}&quot;)
                                 .getResultList();
</pre>
</div>
<p>
					結果セットの行が複数のカラムを持つ場合は
					<code>List</code>
					の要素をJavaBeansにします。
				</p>
<div class="source"><pre>
List&lt;MyDto&gt; result = jdbcManager.callBySql(MyDto.class, &quot;{? = call myfunc}&quot;)
                                .getResultList();
</pre>
</div>
<p>
					INのパラメータが1つだけで、そのパラメータが
					<code>null</code>
					にならない場合は、
					<code>callBySql()</code>
					の3番目の引数で値を直接指定します。
				</p>
<div class="source"><pre>
String result = jdbcManager.callBySql(String.class, &quot;{? = call myfunc(?)}&quot;, &quot;hoge&quot;)
                           .getSingleResult();
</pre>
</div>
<p>
					上記以外の場合は、
					<code>callBySql()</code>
					の3番目の引数にJavaBeansを指定します。
					ストアドファンクションを呼び出すパラメータの順番にJavaBeansのフィールドを定義します。
				</p>
<ul><li>
							フィールドにアノテーションが付けられていない場合、
							<code>IN</code>
							パラメータになります。
						</li>
<li>
							フィールドに
							<code>@Out</code>
							アノテーションが付けられている場合、
							<code>OUT</code>
							パラメータになります。
						</li>
<li>
							フィールドに
							<code>@InOut</code>
							アノテーションが付けられている場合、
							<code>INOUT</code>
							パラメータになります。
						</li>
<li>
							フィールドに
							<code>@ResultSet</code>
							アノテーションが付けられている場合、 パラメータ以外で戻される結果セットになります。
							ただし、 OracleやPostgreSQLのように、
							パラメータ以外で結果セットを返すことが出来ないRDBMSの場合は、
							<code>OUT</code>
							パラメータとして扱われます。
						</li>
<li>
							フィールドに
							<code>@Lob</code>
							が付けられている場合、 そのパラメータはLOBとして扱われます。
							<code>@Lob</code>
							アノテーションは他のアノテーションと組み合わせて使用することが出来ます。
						</li>
</ul>
<div class="source"><pre>
public class MyDto {
    public String arg1; // 第1引数 (IN)

    @Out
    public String arg2; // 第2引数 (OUT)

    @InOut
    public int arg3;    // 第3引数 (INOUT)

    @ResultSet
    public List&lt;String&gt; result; // 結果セット
}
</pre>
</div>
<div class="source"><pre>
MyDto dto = new MyDto();
dto.arg1 = &quot;hoge&quot;;
dto.arg3 = 2;
String result = jdbcManager.callBySql(String.class, &quot;{? = call myfunc(?, ?, ?)}&quot;, dto)
                           .getSingleResult();
System.out.println(result);
System.out.println(dto.arg1);
System.out.println(dto.arg3);
System.out.println(dto.result);
</pre>
</div>
<p>
					ストアドファンクションが複数のカラムを持つ結果セットを返す場合は、
					対応するフィールドの型をList&lt;結果セットの行に対応するJavaBeansの型&gt;にします。
				</p>
<div class="source"><pre>
public class MyDto {
    public int arg1; // 第1引数 (IN)

    @ResultSet
    public List&lt;EmployeeDto&gt; result; // 結果セット
}
</pre>
</div>
<div class="source"><pre>
MyDto dto = new MyDto();
dto.arg1 = 1;
String result = jdbcManager.callBySql(String.class, &quot;{? = call myfunc(?)}&quot;, dto)
                           .getSingleResult();
System.out.println(result);
System.out.println(dto.result);
</pre>
</div>
<p>
					オラクルとPostgreSQLの場合は、戻り値以外の結果セットをパラメータで受け取る必要があります。
					これらのRDBMSでは、
					<code>@ResultSet</code>
					アノテーションが付けられたパラメータは
					<code>OUT</code>
					パラメータとして扱われるので、
					ストアドファンクション呼び出しのSQLの中に対応するバインド変数を付け加えます。
				</p>
<div class="source"><pre>
public class MyDto {
    public int arg1; // 第1引数 (IN)

    @ResultSet
    public List&lt;EmployeeDto&gt; result; // 第2引数 (OUT)
}
</pre>
</div>
<div class="source"><pre>
MyDto dto = new MyDto();
dto.arg1 = 1;
String result = jdbcManager.callBySql(String.class, &quot;{? = call myfunc(?, ?)}&quot;, dto)
                           .getSingleResult();
System.out.println(result);
System.out.println(dto.result);
</pre>
</div>
</div>
</div>

</div><!-- article -->

</div><!-- contents_center -->

<div id="footer">
<address>  &copy; Copyright
  
          2004-2008,
    
          The Seasar Foundation and the others. All rights reserved.
      </address>
<div class="line"><span class="hide">spacer</span></div>
</div><!-- footer -->

</div><!-- wrapper -->

</body>
</html>
